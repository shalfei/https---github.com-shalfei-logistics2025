## Структура файлов
В папке должны лежать файлы:
- `ml_ozon_logistic_dataDurations.json` - база данных расстояний между точками
- `ml_ozon_logistic_dataSetCouriers.json` - данные о курьерах и их сервисных временах
- `ml_ozon_logistic_dataSetOrders.json` - данные о заказах и их локациях

## Основной алгоритм (baseline.py)

### Запуск
```bash
python baseline.py --orders ml_ozon_logistic_dataSetOrders.json --couriers ml_ozon_logistic_dataSetCouriers.json --durations_json ml_ozon_logistic_dataDurations.json --durations_db durations.sqlite --output solution.json
```

### Что делает baseline.py

1. **Загрузка данных**
   - Загружает заказы и курьеров из JSON файлов
   - Использует только первые 280 курьеров из доступных

2. **Построение SQLite базы расстояний**
   - Конвертирует JSON с расстояниями в SQLite для быстрого доступа
   - Создает индексы для оптимизации запросов
   - Обрабатывает файл потоково для экономии памяти

3. **Алгоритм маршрутизации**
   - **Группировка по микро-полигонам**: Заказы группируются по MpId (микро-полигон)
   - **Внутренняя оптимизация**: Внутри каждого полигона используется алгоритм ближайшего соседа (Nearest Neighbor)
   - **Назначение курьерам**: Полигоны назначаются курьерам жадным алгоритмом с учетом ограничений:
     - Максимальное время работы: 12 часов (43200 секунд)
     - Штраф за неразмещенные заказы: 3000 секунд

4. **Оптимизация маршрутов**
   - Вычисляет время маршрута с учетом:
     - Расстояний между точками
     - Сервисного времени курьера в каждой точке
     - Возврата на склад
   - Использует fallback через склад для отсутствующих прямых связей

5. **Выходные данные**
   - Создает файл `solution.json` с маршрутами для каждого курьера
   - Формат: `{"routes": [{"courier_id": X, "route": [0, order1, order2, ..., 0]}]}`

## Проверка решения (scoring.py)

### Запуск
```bash
python scoring.py --orders ml_ozon_logistic_dataSetOrders.json --couriers ml_ozon_logistic_dataSetCouriers.json --durations_db durations.sqlite --submission solution.json
```

### Что делает scoring.py

1. **Валидация решения**
   - Проверяет корректность формата submission.json
   - Валидирует ID курьеров и заказов
   - Проверяет уникальность заказов между маршрутами
   - Убеждается, что заказы из одного микро-полигона не разделены между курьерами

2. **Вычисление расстояний**
   - Ищет прямые связи между точками
   - При отсутствии прямых связей ищет обратные
   - В крайнем случае использует маршрут через склад (ID=0)

3. **Расчет финального скора**
   - Суммирует время всех маршрутов
   - Добавляет штраф за неразмещенные закады (3000 сек за заказ)
   - Проверяет ограничение 12 часов на маршрут

4. **Выходные данные**
   - Выводит статистику по типам связей (прямые, обратные, через склад)
   - Количество неразмещенных заказов
   - Финальный скор в секундах

## Алгоритмические особенности

- **Жадная стратегия**: Полигоны назначаются курьерам по принципу "первый подходящий"
- **Fallback маршрутизация**: При отсутствии прямых связей используется маршрут через склад
- **Оптимизация памяти**: Потоковая обработка больших файлов, LRU кэширование
- **Балансировка нагрузки**: Учет текущего времени работы курьера при назначении новых полигонов

\